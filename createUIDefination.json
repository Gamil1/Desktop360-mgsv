{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Compute.MultiVm",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [

        ],
        "steps": [
            {
                "name": "NetworkConfiguration",
                "label": "Network Configuration",
                "bladeTitle": "Network Configuration for your Virtual Desktop Configuration",
                "subLabel": {
                    "preValidation": "Choose virtual machine size",
                    "postValidation": "Done"
                  },
                "elements": [
                    {
                        "name": "VirtualNetworkConfig",
                        "type": "Microsoft.Network.VirtualNetworkCombo",
                        "label": {
                          "virtualNetwork": "Virtual network",
                          "subnets": "Subnets"
                        },
                        "toolTip": {
                          "virtualNetwork": "",
                          "subnets": ""
                        },
                        "defaultValue": {
                          "name": "Citrix-Vnet",
                          "addressPrefixSize": "/16"
                        },
                        "constraints": {
                          "minAddressPrefixSize": "/16"
                        },
                        "options": {
                          "hideExisting": false
                        },
                        "subnets": {
                          "subnet1": {
                            "label": "Ansible Subnet",
                            "defaultValue": {
                              "name": "AnsibleSubnet",
                              "addressPrefixSize": "/24"
                            },
                            "constraints": {
                              "minAddressPrefixSize": "/24",
                              "minAddressCount": 12,
                              "requireContiguousAddresses": true
                            }
                          },
                          "subnet2": {
                            "label": "Managment Subnet",
                            "defaultValue": {
                              "name": "ManagmentSubnet",
                              "addressPrefixSize": "/24"
                            },
                            "constraints": {
                              "minAddressPrefixSize": "/24",
                              "minAddressCount": 12,
                              "requireContiguousAddresses": true
                            }
                          },
                          "subnet3": {
                            "label": "Virtual Desktop Subnet",
                            "defaultValue": {
                              "name": "VirtualDesktopSubnet",
                              "addressPrefixSize": "/23"
                            },
                            "constraints": {
                              "minAddressPrefixSize": "/23",
                              "minAddressCount": 12,
                              "requireContiguousAddresses": true
                            }
                          },
                          "subnet4": {
                            "label": "Gateway Subnet",
                            "defaultValue": {
                              "name": "Gateway Subnet",
                              "addressPrefixSize": "/26"
                            },
                            "constraints": {
                              "minAddressPrefixSize": "/26",
                              "minAddressCount": 12,
                              "requireContiguousAddresses": true
                            }
                          }

                        },
                        "visible": true
                      }
                ]
            }
        ],
        "outputs": {
            "virtualNetworkName": "[steps(NetworkConfiguration)].VirtualNetworkConfig.name",
            "subnet0Name": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet1.name]",
            "subnet1Name": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet2.name]",
            "subnet2Name": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet3.name]",
            "subnet3Name": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet4.name]",
            "subnet0Prefix": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet1.addressPrefix]",
            "subnet1Prefix": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet2.addressPrefix]",
            "subnet2Prefix": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet3.addressPrefix]",
            "subnet3Prefix": "[steps(NetworkConfiguration).VirtualNetworkConfig.subnets.subnet4.addressPrefix]"
        }
    }
}